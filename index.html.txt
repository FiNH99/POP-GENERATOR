<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>POP Generator PDF 60x20cm</title>

<!-- html2canvas -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<!-- jsPDF -->
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

<style>
body {
  font-family: Arial, Helvetica, sans-serif;
  background: #f2f2f2;
  padding: 20px;
}

select, button {
  font-size: 18px;
  padding: 10px 15px;
  margin-right: 10px;
}

/* ===== POP 60x20 CM (300 DPI) ===== */
.pop {
  width: 7087px;
  height: 2362px;
  background: #4f86c6;
  padding: 120px;
  box-sizing: border-box;
}

.card {
  width: 100%;
  height: 100%;
  background: white;
  border-radius: 120px;
  padding: 120px;
  box-sizing: border-box;
  display: flex;
  gap: 120px;
}

.left {
  width: 25%;
  display: flex;
  justify-content: center;
  align-items: center;
}

.left img {
  max-width: 100%;
}

.right {
  width: 75%;
}

.right img {
  max-width: 600px;
}

/* TEXT */
h2 {
  font-size: 160px;
  margin: 40px 0;
}

p {
  font-size: 90px;
  margin: 30px 0;
}

.old-price {
  font-size: 110px;
  text-decoration: line-through;
  color: #666;
}

.promo-price {
  background: red;
  color: white;
  font-size: 200px;
  font-weight: bold;
  padding: 60px 140px;
  border-radius: 100px;
  display: inline-block;
  margin: 40px 0;
}
</style>
</head>

<body>

<h2>POP Generator → PDF (60 × 20 cm)</h2>

<select id="produk">
  <option value="">-- Pilih Produk --</option>
</select>

<button onclick="generatePOP()">Generate POP</button>

<div id="hasil"></div>

<script>
const API_URL = "PASTE_API_URL_DISINI";
let db = [];

/* LOAD DATABASE */
fetch(API_URL)
.then(res => res.json())
.then(data => {
  db = data;
  const select = document.getElementById("produk");
  data.forEach(d => {
    const opt = document.createElement("option");
    opt.value = d.id;
    opt.textContent = d.nama_produk;
    select.appendChild(opt);
  });
});

/* GENERATE POP */
function generatePOP() {
  const id = document.getElementById("produk").value;
  if (!id) return alert("Pilih produk");

  const d = db.find(x => x.id == id);

  document.getElementById("hasil").innerHTML = `
    <div id="popCanvas" class="pop">
      <div class="card">

        <div class="left">
          <img src="${d.gambar_badge}" crossorigin="anonymous">
        </div>

        <div class="right">
          <img src="${d.gambar_produk}" crossorigin="anonymous"><br><br>

          <h2>${d.nama_produk}</h2>
          <p>${d.varian}</p>

          <div class="old-price">Rp ${rupiah(d.harga_normal)}</div>
          <div class="promo-price">Rp ${rupiah(d.harga_promo)}</div>

          <p>Periode: ${d.periode}</p>
        </div>

      </div>
    </div>

    <br>
    <button onclick="downloadPDF()">Download PDF</button>
  `;
}

/* EXPORT PDF 60x20 CM */
async function downloadPDF() {
  const element = document.getElementById("popCanvas");

  const canvas = await html2canvas(element, {
    scale: 1,
    useCORS: true,
    backgroundColor: "#4f86c6"
  });

  const imgData = canvas.toDataURL("image/jpeg", 1.0);

  const { jsPDF } = window.jspdf;

  const pdf = new jsPDF({
    orientation: "landscape",
    unit: "cm",
    format: [60, 20]
  });

  pdf.addImage(imgData, "JPEG", 0, 0, 60, 20);
  pdf.save("POP_60x20cm_PRINT.pdf");
}

/* FORMAT RUPIAH */
function rupiah(x) {
  return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
}
</script>

</body>
</html>